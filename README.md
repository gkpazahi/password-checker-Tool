# Password checker Tool

A robust Python module for securely managing user passwords with comprehensive validation, encryption, and storage in MongoDB.

## Features

### **Security Features**
- ** 4-Step Password Validation Process**
  - Basic complexity requirements (length, uppercase, lowercase, digits, special chars)
  - Compromised password checking via HIBP API
  - Password reuse prevention (checks historical passwords)
  - Password expiry tracking and enforcement

- **Encryption & Storage**
  - AES encryption using Fernet (cryptography library)
  - Secure storage in MongoDB with encrypted passwords
  - Automatic encryption key management via environment variables

### **Password History Tracking**
- Automatic archiving of expired passwords
- Maintains last 10 password history per user
- Prevents password reuse from history
- Queryable password history with timestamps

### **Performance Optimizations**
- **Bloom Filter** for fast compromised password checking offline
- Two-level password compromise detection:
  1. Local Bloom filter check (1M+ passwords)
  2. HIBP API fallback (Have I Been Pwned)

## Installation

```bash
pip install -r requirements.txt
```

### Requirements:
```txt
pymongo
cryptography
requests
pybloom-live
python-dotenv
```

## Quick Start

```python
from password_checker import PasswordChecker
import pymongo

# Initialize
checker = PasswordChecker()

# Generate encryption key (saved to .env)
key = checker.generate_encryption_key()

# Connect to MongoDB
client = pymongo.MongoClient("mongodb://localhost:27017/")
db = client["password_vault"]
collection = db["users"]

# Get user credentials
username, password = checker.get_user_credentials()

# Validate password
if checker.validate_password(username, password, key, collection):
    # Store securely
    checker.store_password_in_vault(username, password, collection, key)
    print("Password stored successfully!")
else:
    print("Password validation failed.")
```

## Database Schema

```python
{
    "username": "john_doe",
    "encrypted_password": "<encrypted_bytes>",
    "creation_date": datetime,
    "expiration_date": datetime,
    "last_updated": datetime,
    "old_passwords": [
        {
            "password": "<encrypted_old_password>",
            "archived_at": datetime,
            "reason": "password_expired"
        }
    ]
}
```

## Key Methods

### Core Validation Methods:
- `is_valid(password)` - Checks password complexity rules
- `is_compromised(password)` - Checks against breached passwords
- `is_already_used(password)` - Prevents password reuse
- `is_password_expired(username)` - Checks and archives expired passwords

### Storage & Management:
- `store_password_in_vault()` - Securely stores passwords
- `archive_old_password()` - Archives expired passwords
- `get_password_history()` - Retrieves password history
- `force_password_change()` - Admin function to force password reset

## Configuration

Customize password requirements:
```python
checker = PasswordChecker(
    min_length=12,
    require_uppercase=True,
    require_lowercase=True,
    require_digit=True,
    require_special=True
)
```

## Environment Setup

Create a `.env` file:
```env
ENCRYPTION_KEY=<auto-generated-or-manual-key>
```

## Security Notes
**Best Practices Implemented:**
- No passwords stored in plaintext
- HIBP API uses k-anonymity (only first 5 chars of SHA-1 hash sent)
- Encrypted storage with proper key management
- Prevention of password reuse
- Regular password expiry

**Requirements:**
- Requires MongoDB running locally or remotely
- Internet connection for HIBP API checks
- Local `compromised_password.txt` file for Bloom filter

## License

MIT License - Feel free to use in your projects with proper attribution.
**Contributions welcome!** Report issues or suggest features via GitHub issues.
